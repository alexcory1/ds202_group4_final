---
title: "readme"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

library(data.table)
df <- fread('MD_COVID-19_-_MASTER_Case_Tracker.csv')
show(df)
```

## Including Plots
```{r}
library(zoo)
library(tidyverse)
library(lubridate)
library(dplyr)
```

```{r}


df1 <- df %>% dplyr::mutate(year = year(as.Date(df$ReportDate,format="%m/%d/%Y")),
                 month = lubridate::month(as.Date(df$ReportDate,format="%m/%d/%Y")),
                 day = lubridate::day(as.Date(df$ReportDate,format="%m/%d/%Y")),
                 date = my(format(as.Date(df$ReportDate,format = "%m/%d/%Y"),"%m/%y")))
```


You can also embed plots, for example:
```{r}
ggplot(data=df1, aes(x=df1$date, y=df1$TotalCases, color= df1$CaseDelta)) +
  labs(x = "Month", y = "Total Cases", color = "New Cases") +
  scale_colour_gradientn(colors=rainbow(4)) +
  geom_line()+
  geom_point() +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "2 month") +
  ggtitle("Total Cases Over Time") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
ggplot(data=df1, aes(x=df1$date, y=df1$PosTestPercent, color = df1$TestsDelta)) +
  geom_line() +
  labs(color = "New Tests", x = "Month", y = "Percentage of Positive Tests") +
  scale_colour_gradientn(colors=rainbow(4)) +
  geom_point() +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "2 month") +
  ggtitle("Percent Positive Over Time") + 
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
proportion_released = df1$total_released / df1$total_hospitalized
ggplot(data=df1, aes(x=df1$date, y=proportion_released, color=CaseDelta)) +
  scale_colour_gradientn(colors=rainbow(4)) +
  xlab("Month Reported") +
  ylab("Proportion Released") +
  geom_point() +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "2 month") +
  ggtitle("Proportion Released from Hospital by Month")
  theme(axis.text.x = element_text(angle = 45, hjust=1))

```

This graph shows the correlation between new cases and new deaths. Only 43% of the variability in new deaths can be explained by new cases.

```{r}

df1$NegDelta[is.na(df1$NegDelta)] = 0
df1$bedsDelta[is.na(df1$bedsDelta)] = 0
df1$deathsDelta[is.na(df1$deathsDelta)] = 0
df1$CaseDelta[is.na(df1$CaseDelta)] = 0
df1$pDeathsDelta[is.na(df1$pDeathsDelta)] = 0
df1$TestsDelta[is.na(df1$TestsDelta)] = 0
df1$releasedDelta[is.na(df1$releasedDelta)] = 0
df1$hospitalizedDelta[is.na(df1$hospitalizedDelta)] = 0

df1 <- df1 %>% mutate_all(.funs = funs(na.locf0(.)))

ggplot(data=df1, aes(x=df1$deathsDelta, y=df1$CaseDelta)) +
  labs(y = "New Cases", x = "New Deaths") +
  geom_point() +
  ggtitle("New Deaths by New Cases")
  geom_abline(color = "red")
```
```{r}

ggp1 <- ggplot(data = df1, aes(x=df1$date)) +       
  geom_line(aes(y = df1$genMale), color = "lightblue", size=2) +
  geom_line(aes(y = df1$genFemale), color = "pink", size=2) +
  labs(x="Date", y="Cases") +
  ggtitle("Cases by Gender Over Time (Pink to Female, Blue to Male)") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))

ggp1     

```
```{r}

ggp1 <- ggplot(data = df1, aes(x=df1$date)) +       
  geom_line(aes(y = df1$deathGenMale), color = "lightblue", size=2) +
  geom_line(aes(y = df1$deathGenFemale), color = "pink", size=2) +
  labs(x="Date", y="Deaths") +
  ggtitle("Deaths by Gender Over Time (Pink to Female, Blue to Male)") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))

ggp1     

```

```{r}
agc <- df1 %>% pivot_longer(
  col = c(case0to9,case10to19,case20to29,case30to39,case40to49,case50to59,case60to69,case70to79,case80plus),
  names_to = "ageGroup",
  values_to = "cases")

ggplot(data = agc, aes(x = `date`, y = `cases`)) +
  facet_wrap(~agc$ageGroup) +
  labs(x = "Month", y = "Cases by Age Range") +
  geom_line()+
  geom_point() +
  ggtitle("Cases by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
agc$proportion = agc$cases / agc$TotalCases

ggplot(data = agc, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~agc$ageGroup) +
  labs(x = "Month", y = "Proportion of Total Cases") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Cases by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
agd <- df1 %>% pivot_longer(
  col = c(death0to9,death10to19,death20to29,death30to39,death40to49,death50to59,death60to69,death70to79,death80plus),
  names_to = "ageGroup",
  values_to = "deathByGroup")

ggplot(data = agd, aes(x = `date`, y = `deathByGroup`)) +
  facet_wrap(~agd$ageGroup) +
  labs(x = "Month", y = "Deaths by Age Range") +
  geom_line()+
  geom_point() +
  ggtitle("Deaths by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
```{r}
agd$proportion = agd$deathByGroup / agd$deaths

ggplot(data = agc, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~agd$ageGroup) +
  labs(x = "Month", y = "Proportion of Total Deaths") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Deaths by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
cbr <- df1 %>% pivot_longer(
  col = c(caseAfrAmer,caseWhite,caseHispanic,caseAsian,caseOther,caseNotAVail),
  names_to = "race",
  values_to = "cases")

ggplot(data = cbr, aes(x = `date`, y = `cases`)) +
  facet_wrap(~cbr$race) +
  labs(x = "Month", y = "Cases by Race") +
  geom_line()+
  geom_point() +
  ggtitle("Cases by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
cbr$proportion = cbr$cases / cbr$TotalCases

ggplot(data = cbr, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~cbr$race) +
  labs(x = "Month", y = "Proportion of Total Cases") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Cases by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
dbr <- df1 %>% pivot_longer(
  col = c(deathAfrAmer,deathWhite,deathHispanic,deathAsian,deathOther,deathNotAvail),
  names_to = "race",
  values_to = "deathByRace")

ggplot(data = dbr, aes(x = `date`, y = `deathByRace`)) +
  facet_wrap(~dbr$race) +
  labs(x = "Month", y = "Deaths by Race") +
  geom_line()+
  geom_point() +
  ggtitle("Deaths by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
dbr$proportion = dbr$deathByRace / dbr$deaths

ggplot(data = dbr, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~dbr$race) +
  labs(x = "Month", y = "Proportion of Total Deaths") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Deaths by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
