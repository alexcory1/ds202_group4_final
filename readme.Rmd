---
title: "readme"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown











This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:



We created several visualizations displaying Maryland’s COVID-19 data based on several factors including race, gender, and age. We found that older individuals tended to have more deaths and die at a much higher proportion than younger age groups. We also found that white and African American individuals died at the highest rate in the state. Another finding of ours was that despite women being more likely to contract COVID-19, more men died from it than women.

```{r}

library(data.table)
df <- fread('MD_COVID-19_-_MASTER_Case_Tracker.csv')
show(df)
```

## Including Plots
```{r}
library(zoo)
library(tidyverse)
library(lubridate)
library(dplyr)
```

```{r}


df1 <- df %>% dplyr::mutate(year = year(as.Date(df$ReportDate,format="%m/%d/%Y")),
                 month = lubridate::month(as.Date(df$ReportDate,format="%m/%d/%Y")),
                 day = lubridate::day(as.Date(df$ReportDate,format="%m/%d/%Y")),
                 date = my(format(as.Date(df$ReportDate,format = "%m/%d/%Y"),"%m/%y")))
```


You can also embed plots, for example:
```{r}
ggplot(data=df1, aes(x=df1$date, y=df1$TotalCases, color= df1$CaseDelta)) +
  labs(x = "Month", y = "Total Cases", color = "New Cases") +
  scale_colour_gradientn(colors=rainbow(4)) +
  geom_line()+
  geom_point() +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "2 month") +
  ggtitle("Total Cases Over Time") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Total Cases Over Time
This graph shows the increase in cases over time. The color shows the change in cases with red being a low change and purple being a higher increase.



```{r}
ggplot(data=df1, aes(x=df1$date, y=df1$PosTestPercent, color = df1$TestsDelta)) +
  geom_line() +
  labs(color = "New Tests", x = "Month", y = "Percentage of Positive Tests") +
  scale_colour_gradientn(colors=rainbow(4)) +
  geom_point() +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "2 month") +
  ,ggtitle("Percent Positive Over Time") + 
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

Percent Positive Over Time
Shows the positivity rate over time. Color shows daily number of new tests. One notable feature of the graph is that at the beginning we can see that there are very few tests but have a high positivity rate.  We can infer that this is caused by the lack of tests making it hard for people who aren't absolutely sure they have it to get tested. Another feature of the graph is the spikes around Christmas time when people are getting together and are at higher risk of transmitting the disease. Based on this, we can predict that in the coming month or so there will be a significant increase in cases due to Christmas.


Proportion Released From Hospital Each Month
This graph shows the percentage of people released from the hospital each month. Our graph shows that the rate of dismissals had been decreasing up until the end of 2021, when they stopped reporting data on it.


```{r}
proportion_released = df1$total_released / df1$total_hospitalized
ggplot(data=df1, aes(x=df1$date, y=proportion_released, color=CaseDelta)) +
  scale_colour_gradientn(colors=rainbow(4)) +
  xlab("Month Reported") +
  ylab("Proportion Released") +
  geom_point() +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "2 month") +
  ggtitle("Proportion Released from Hospital by Month")
  theme(axis.text.x = element_text(angle = 45, hjust=1))

```

New Deaths by New Cases
This graph shows the relationship between change in deaths and the change in cases. Our R^2 value was .43 meaning that 43% of the variability in the change in deaths can be accounted for by the change in cases. This low correlation makes sense because the new cases shouldn’t have an impact on the probability of someone already having the disease dying.


```{r}

df1$NegDelta[is.na(df1$NegDelta)] = 0
df1$bedsDelta[is.na(df1$bedsDelta)] = 0
df1$deathsDelta[is.na(df1$deathsDelta)] = 0
df1$CaseDelta[is.na(df1$CaseDelta)] = 0
df1$pDeathsDelta[is.na(df1$pDeathsDelta)] = 0
df1$TestsDelta[is.na(df1$TestsDelta)] = 0
df1$releasedDelta[is.na(df1$releasedDelta)] = 0
df1$hospitalizedDelta[is.na(df1$hospitalizedDelta)] = 0

df1 <- df1 %>% mutate_all(.funs = funs(na.locf0(.)))

ggplot(data=df1, aes(x=df1$deathsDelta, y=df1$CaseDelta)) +
  labs(y = "New Cases", x = "New Deaths") +
  geom_point() +
  ggtitle("New Deaths by New Cases")
  geom_abline(color = "red")
```
```{r}

ggp1 <- ggplot(data = df1, aes(x=df1$date)) +       
  geom_line(aes(y = df1$genMale), color = "lightblue", size=2) +
  geom_line(aes(y = df1$genFemale), color = "pink", size=2) +
  labs(x="Date", y="Cases") +
  ggtitle("Cases by Gender Over Time (Pink to Female, Blue to Male)") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))

ggp1     

```
```{r}

ggp1 <- ggplot(data = df1, aes(x=df1$date)) +       
  geom_line(aes(y = df1$deathGenMale), color = "lightblue", size=2) +
  geom_line(aes(y = df1$deathGenFemale), color = "pink", size=2) +
  labs(x="Date", y="Deaths") +
  ggtitle("Deaths by Gender Over Time (Pink to Female, Blue to Male)") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))

ggp1     

```

```{r}
agc <- df1 %>% pivot_longer(
  col = c(case0to9,case10to19,case20to29,case30to39,case40to49,case50to59,case60to69,case70to79,case80plus),
  names_to = "ageGroup",
  values_to = "cases")

ggplot(data = agc, aes(x = `date`, y = `cases`)) +
  facet_wrap(~agc$ageGroup) +
  labs(x = "Month", y = "Cases by Age Range") +
  geom_line()+
  geom_point() +
  ggtitle("Cases by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```

```{r}
agc$proportion = agc$cases / agc$TotalCases

ggplot(data = agc, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~agc$ageGroup) +
  labs(x = "Month", y = "Proportion of Total Cases") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Cases by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Proportion of Cases by Age Range
This graph shows the distribution of ages of people with confirmed COVID cases. Our graph had some interesting shapes to it. We would expect the curves to all be flat at some specific percentage. However, cases in the 0-19 range increased over time, and cases in the 40+ ages decreased over time. One thing that might have caused this is deaths in the older age groups being more prevalent than those in younger age groups.


```{r}
agd <- df1 %>% pivot_longer(
  col = c(death0to9,death10to19,death20to29,death30to39,death40to49,death50to59,death60to69,death70to79,death80plus),
  names_to = "ageGroup",
  values_to = "deathByGroup")

ggplot(data = agd, aes(x = `date`, y = `deathByGroup`)) +
  facet_wrap(~agd$ageGroup) +
  labs(x = "Month", y = "Deaths by Age Range") +
  geom_line()+
  geom_point() +
  ggtitle("Deaths by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Deaths by Age Range
This graph shows the number of deaths in each age range. The notable information we can see in this graph is that there are very few deaths in the young age ranges, but very many deaths in the older age ranges. This could be an indication of why the proportions of old cases decreased over time.
```{r}
agd$proportion = agd$deathByGroup / agd$deaths

ggplot(data = agd, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~agd$ageGroup) +
  labs(x = "Month", y = "Proportion of Total Deaths") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Deaths by Age Range") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Proportion of Deaths by Age Range
This graph shows the proportion of deaths based on each age range. Something notable about this graph is that there are close to no deaths in the 0-49 range, but there is a steady increase starting around 50, and an even bigger increase in the 80+ group.

```{r}
cbr <- df1 %>% pivot_longer(
  col = c(caseAfrAmer,caseWhite,caseHispanic,caseAsian,caseOther,caseNotAVail),
  names_to = "race",
  values_to = "cases")

ggplot(data = cbr, aes(x = `date`, y = `cases`)) +
  facet_wrap(~cbr$race) +
  labs(x = "Month", y = "Cases by Race") +
  geom_line()+
  geom_point() +
  ggtitle("Cases by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Cases by Race
This breaks down the number of cases by race. The two races with the most cases were white and African American. There were also a good number of hispanic cases, but very few Asian and other cases.

```{r}
cbr$proportion = cbr$cases / cbr$TotalCases

ggplot(data = cbr, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~cbr$race) +
  labs(x = "Month", y = "Proportion of Total Cases") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Cases by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Proportion of Cases by Race
This shows the proportion of cases by race. White and African American cases tended to make up about 30-40% of all cases in the state each, and Asian cases never made up more than 10% of cases.

```{r}
dbr <- df1 %>% pivot_longer(
  col = c(deathAfrAmer,deathWhite,deathHispanic,deathAsian,deathOther,deathNotAvail),
  names_to = "race",
  values_to = "deathByRace")

ggplot(data = dbr, aes(x = `date`, y = `deathByRace`)) +
  facet_wrap(~dbr$race) +
  labs(x = "Month", y = "Deaths by Race") +
  geom_line()+
  geom_point() +
  ggtitle("Deaths by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Deaths by Race
This set of graphs shows the number of deaths in each racial group. White people had the most deaths, surpassing 7500. This was followed by African Americans sitting around 5000, then Hispanic and Asian individuals with around 1000 each.


```{r}
dbr$proportion = dbr$deathByRace / dbr$deaths

ggplot(data = dbr, aes(x = `date`, y = `proportion`)) +
  facet_wrap(~dbr$race) +
  labs(x = "Month", y = "Proportion of Total Deaths") +
  geom_line()+
  geom_point() +
  ggtitle("Proportion of Deaths by Race") +
  scale_x_date(date_labels = "%m-%y",
               date_breaks = "4 month") +
  theme(axis.text.x = element_text(angle = 45, hjust=1))
```
Proportion of Deaths by Race
This shows what proportion of deaths each racial group makes up. White individuals made up around 50% of all deaths, followed closely by African Americans, who made up nearly 40%.

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
